{"version":3,"sources":["node_modules/browser-pack/_prelude.js","app/index.js","app/Game.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.build.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\r\n\r\nvar Game = require('./Game');\r\n\r\nvar game = new Game();\r\n\r\n// timer\r\nfunction getTimeRemaining(endtime) {\r\n\tvar total = Date.parse(endtime) - Date.parse(new Date());\r\n\tvar seconds = Math.floor((total / 1000) % 60);\r\n\r\n\treturn {\r\n\t\t'total': total,\r\n\t\t'seconds': seconds\r\n\t};\r\n}\r\n\r\nfunction initializeClock(id, endtime) {\r\n  var timer = document.querySelector('#timer');\r\n  var secondsDisplay = timer.querySelector('#seconds');\r\n\r\n  function updateClock() {\r\n    var time = getTimeRemaining(endtime);\r\n\r\n    secondsDisplay.innerHTML = ('0' + time.seconds).slice(-2);\r\n\r\n  \tif (time.total <= 0) {\r\n  \t\tclearInterval(timeinterval);\r\n  \t}\r\n\r\n  \tif (time.seconds === 1) {\r\n\t\t\tvar overlay = document.querySelector('.end-game');\r\n\t\t\tTweenLite.to(overlay, 0.5, {\r\n\t\t\t\tdelay: 0.5,\r\n\t\t\t\topacity: 1,\r\n\t\t\t\tzIndex: 15,\r\n\t\t\t\tease: Power4.easeOut\r\n\t\t\t});\r\n  \t}\r\n   }\r\n\r\n  updateClock();\r\n  var timeinterval = setInterval(updateClock, 1000);\r\n}\r\n\r\nvar countdownEndtime = new Date(Date.parse(new Date()) + 15 * 24 * 60 * 60 * 1000);\r\ninitializeClock('timer-container', countdownEndtime);\r\n","'use strict';\r\n\r\n// Handle keyboard controls\r\nvar keysDown = {};\r\n\r\n/**\r\n * Game layout and mechanics\r\n */\r\nvar Game = function() {\r\n\tthis.canvas = document.querySelector('#game');\r\n\tthis.ctx = this.canvas.getContext('2d');\r\n\tthis.canvas.width = window.innerWidth;\r\n\tthis.canvas.height = window.innerHeight;\r\n\r\n\taddEventListener('keydown', function (e) {\r\n\t\tkeysDown[e.keyCode] = true;\r\n\t}, false);\r\n\r\n\taddEventListener('keyup', function (e) {\r\n\t\tdelete keysDown[e.keyCode];\r\n\t}, false);\r\n\r\n\tthis.displayCollected = document.querySelector('#collection');\r\n\r\n\tthis.init();\r\n\r\n\twindow.addEventListener('resize', this._onResize.bind(this));\r\n};\r\n\r\n/**\r\n * initialize game objects\r\n */\r\nGame.prototype.init = function() {\r\n\tthis.drawBackground();\r\n\tthis.drawSanta();\r\n\tthis.drawGift();\r\n\tthis.dPad();\r\n\r\n\tthis.then = Date.now();\r\n\r\n\t// Game objects\r\n\tthis.santaCharacter = {\r\n\t\tspeed: (256 * 2) // movement in pixels per second\r\n\t};\r\n\r\n\tthis.giftToGet = {};\r\n\tthis.giftsCollected = 0;\r\n\tthis.displayCollected.innerHTML = this.giftsCollected;\r\n\r\n\tthis.santaCharacter.x = this.canvas.width / 2;\r\n\tthis.santaCharacter.y = this.canvas.height / 2;\r\n\r\n\tthis.setRandomGiftLocation();\r\n\tthis.animate();\r\n\r\n\tthis.moving = false;\r\n\tthis.movingX = false;\r\n\tthis.movingY = false;\r\n\r\n\t// tally and display score after 60s\r\n\tvar overlay = document.querySelector('.end-game');\r\n\tTweenLite.to(overlay, 0.5, {\r\n\t\tdelay: 59,\r\n\t\tonStart: function() {\r\n\t\t\tdocument.querySelector('#finalScore').innerHTML = this.giftsCollected + ' lost presents!';\r\n\t\t}.bind(this)\r\n\t});\r\n};\r\n\r\n/**\r\n * lays out bg image\r\n */\r\nGame.prototype.drawBackground = function() {\r\n\tthis.bgImage = new Image();\r\n\tthis.bgImage.src = 'images/bg-ice-tile-x.jpg';\r\n};\r\n\r\n/**\r\n * lays out santa image\r\n */\r\nGame.prototype.drawSanta = function() {\r\n\tthis.santa = new Image();\r\n\tthis.santaFlip = new Image();\r\n\r\n\tthis.santa.src = 'images/santa-sleigh.png';\r\n\tthis.santaFlip.src = 'images/santa-sleigh_flip.png';\r\n};\r\n\r\n/**\r\n * lays out gift image\r\n */\r\nGame.prototype.drawGift = function() {\r\n\tthis.gift = new Image();\r\n\tthis.gift.src = 'images/gift.png';\r\n};\r\n\r\n/**\r\n * Throw the new gift somewhere on the screen randomly\r\n */\r\nGame.prototype.setRandomGiftLocation = function () {\r\n\tthis.giftToGet.x = 32 + (Math.random() * (this.canvas.width - 64));\r\n\tthis.giftToGet.y = 32 + (Math.random() * (this.canvas.height - 64));\r\n};\r\n\r\n/**\r\n * Update game objects\r\n */\r\nGame.prototype.update = function (modifier) {\r\n\tif (38 in keysDown) { // Player holding up\r\n\r\n\t\tif (this.santaCharacter.y >= 64 && !this.movingY) {\r\n\r\n\t\t\tthis._moveUp(modifier);\r\n\t\t};\r\n\t}\r\n\r\n\tif (40 in keysDown) { // Player holding down\r\n\r\n\t\tif (this.santaCharacter.y <= this.canvas.height - 128 && !this.movingY) {\r\n\t\t\tthis._moveDown(modifier);\r\n\t\t};\r\n\t}\r\n\r\n\tif (37 in keysDown) { // Player holding left\r\n\r\n\t\tthis.santa.src = 'images/santa-sleigh.png';\r\n\r\n\t\tif (this.santaCharacter.x >= 64 && !this.movingX) {\r\n\t\t\tthis._moveLeft(modifier);\r\n\t\t};\r\n\t}\r\n\r\n\tif (39 in keysDown) { // Player holding right\r\n\r\n\t\tthis.santa.src = 'images/santa-sleigh_flip.png';\r\n\r\n\t\tif (this.santaCharacter.x <= (this.canvas.width - 128) && !this.movingX) {\r\n\t\t\tthis._moveRight(modifier);\r\n\t\t};\r\n\t}\r\n\r\n\t// collision detection\r\n\tif (this.santaCharacter.x <= (this.giftToGet.x + 32) && this.giftToGet.x <= (this.santaCharacter.x + 32) && this.santaCharacter.y <= (this.giftToGet.y + 32)\r\n && this.giftToGet.y <= (this.santaCharacter.y + 32)) {\r\n\r\n\t\tif (this.giftsCollected >= 0) {\r\n\t\t\tthis.giftsCollected++;\r\n\r\n\t\t\tthis.displayCollected.innerHTML = this.giftsCollected;\r\n\r\n\t\t\tthis.setRandomGiftLocation();\r\n\t\t}\r\n\t}\r\n};\r\n\r\n/**\r\n * move up motion/animation\r\n */\r\nGame.prototype._moveUp = function(modifier) {\r\n\tthis.movingY = true;\r\n\r\n\tTweenLite.to(this.santaCharacter, 0.75, {\r\n\t\ty: this.santaCharacter.y - this.santaCharacter.speed * modifier,\r\n\t\tease: Power1.easeOut,\r\n\t\tonComplete: this._hasFinishedMovingY.bind(this)\r\n\t});\r\n};\r\n\r\n/**\r\n * move down motion/animation\r\n */\r\nGame.prototype._moveDown = function(modifier) {\r\n\tthis.movingY = true;\r\n\r\n\tTweenLite.to(this.santaCharacter, 0.75, {\r\n\t\ty: this.santaCharacter.y + this.santaCharacter.speed * modifier,\r\n\t\tease: Power1.easeOut,\r\n\t\tonComplete: this._hasFinishedMovingY.bind(this)\r\n\t});\r\n};\r\n\r\n/**\r\n * move left motion/animation\r\n */\r\nGame.prototype._moveLeft = function(modifier) {\r\n\tthis.movingX = true;\r\n\r\n\tTweenLite.to(this.santaCharacter, 0.75, {\r\n\t\tx: this.santaCharacter.x - this.santaCharacter.speed * modifier,\r\n\t\tease: Power1.easeOut,\r\n\t\tonComplete: this._hasFinishedMovingX.bind(this)\r\n\t});\r\n};\r\n\r\n/**\r\n * move right motion/animation\r\n */\r\nGame.prototype._moveRight = function(modifier) {\r\n\tthis.movingX = true;\r\n\r\n\tTweenLite.to(this.santaCharacter, 0.75, {\r\n\t\tx: this.santaCharacter.x + this.santaCharacter.speed * modifier,\r\n\t\tease: Power1.easeOut,\r\n\t\tonComplete: this._hasFinishedMovingX.bind(this)\r\n\t});\r\n};\r\n\r\n/**\r\n * finished moving on X axis flag\r\n */\r\nGame.prototype._hasFinishedMovingX = function() {\r\n\tthis.movingX = false;\r\n};\r\n\r\n/**\r\n * finished moving on Y axis flag\r\n */\r\nGame.prototype._hasFinishedMovingY = function() {\r\n\tthis.movingY = false;\r\n};\r\n\r\n/**\r\n * finished moving flag\r\n */\r\nGame.prototype._hasFinishedMoving = function() {\r\n\tthis.moving = false;\r\n};\r\n\r\n/**\r\n * draw everything\r\n */\r\nGame.prototype.render = function () {\r\n\tvar repeatPattern = this.ctx.createPattern(this.bgImage, 'repeat'); // Create a pattern with this image, and set it to 'repeat'.\r\n \tthis.ctx.fillStyle = repeatPattern;\r\n  this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n\r\n\tthis.ctx.drawImage(this.santa, this.santaCharacter.x, this.santaCharacter.y);\r\n\tthis.ctx.drawImage(this.gift, this.giftToGet.x, this.giftToGet.y);\r\n};\r\n\r\n/**\r\n * Main game loop\r\n */\r\nGame.prototype.animate = function () {\r\n\tvar now = Date.now();\r\n\tvar delta = now - this.then;\r\n\r\n\tthis.update(delta / 150);\r\n\tthis.render();\r\n\r\n\tthis.then = now;\r\n\r\n\trequestAnimationFrame(this.animate.bind(this));\r\n};\r\n\r\n/**\r\n * Directional Pad - mobile ui\r\n */\r\nGame.prototype.dPad = function() {\r\n\t// mobile d pad movement\r\n\tvar up = document.querySelector('#top');\r\n\tvar left = document.querySelector('#left');\r\n\tvar right = document.querySelector('#right');\r\n\tvar bottom = document.querySelector('#down');\r\n\r\n  // tap up\r\n  up.addEventListener('click', function() {\r\n\t\tif (this.santaCharacter.y >= 0) {\r\n\t\t\tTweenLite.to(this.santaCharacter, 0.25, {\r\n\t\t\t\ty: this.santaCharacter.y - 25.5,\r\n\t\t\t\tease: Power1.easeOut\r\n\t\t\t});\r\n\t\t};\r\n\t}.bind(this));\r\n\r\n  // tap down\r\n  down.addEventListener('click', function() {\r\n\t\tif (this.santaCharacter.y <= this.canvas.height - 64) {\r\n\t\t\tTweenLite.to(this.santaCharacter, 0.25, {\r\n\t\t\t\ty: this.santaCharacter.y + 25.5,\r\n\t\t\t\tease: Power1.easeOut\r\n\t\t\t});\r\n\t\t};\r\n\t}.bind(this));\r\n\r\n  // tap left\r\n  left.addEventListener('click', function() {\r\n\t\tif (this.santaCharacter.x >= 0) {\r\n\t\t\tTweenLite.to(this.santaCharacter, 0.25, {\r\n\t\t\t\tx: this.santaCharacter.x - 25.5,\r\n\t\t\t\tease: Power1.easeOut\r\n\t\t\t});\r\n\t\t\tthis.santa.src = 'images/santa-sleigh.png';\r\n\t\t};\r\n\t}.bind(this));\r\n\r\n  // tap right\r\n  right.addEventListener('click', function() {\r\n\t\tif (this.santaCharacter.x <= (this.canvas.width - 32)) {\r\n\t\t\tTweenLite.to(this.santaCharacter, 0.25, {\r\n\t\t\t\tx: this.santaCharacter.x + 25.5,\r\n\t\t\t\tease: Power1.easeOut\r\n\t\t\t});\r\n\t\t\tthis.santa.src = 'images/santa-sleigh_flip.png';\r\n\t\t};\r\n\t}.bind(this));\r\n};\r\n\r\n/**\r\n * on resize stuff\r\n */\r\nGame.prototype._onResize = function() {\r\n\tthis.canvas.width = window.innerWidth;\r\n\tthis.canvas.height = window.innerHeight;\r\n\r\n\tthis.init();\r\n};\r\n\r\nmodule.exports = Game;\r\n"],"preExisting":"//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlc1xcYnJvd3Nlci1wYWNrXFxfcHJlbHVkZS5qcyIsIi4vYXBwL2luZGV4LmpzIiwiRDovcHJvamVjdHMvcGVyc29uYWwvMjVLLWNoYWxsZW5nZS1naXRodWIvYXBwL0dhbWUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxudmFyIEdhbWUgPSByZXF1aXJlKCcuL0dhbWUnKTtcclxuXHJcbnZhciBnYW1lID0gbmV3IEdhbWUoKTtcclxuXHJcbi8vIHRpbWVyXHJcbmZ1bmN0aW9uIGdldFRpbWVSZW1haW5pbmcoZW5kdGltZSkge1xyXG5cdHZhciB0b3RhbCA9IERhdGUucGFyc2UoZW5kdGltZSkgLSBEYXRlLnBhcnNlKG5ldyBEYXRlKCkpO1xyXG5cdHZhciBzZWNvbmRzID0gTWF0aC5mbG9vcigodG90YWwgLyAxMDAwKSAlIDYwKTtcclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdCd0b3RhbCc6IHRvdGFsLFxyXG5cdFx0J3NlY29uZHMnOiBzZWNvbmRzXHJcblx0fTtcclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdGlhbGl6ZUNsb2NrKGlkLCBlbmR0aW1lKSB7XHJcbiAgdmFyIHRpbWVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3RpbWVyJyk7XHJcbiAgdmFyIHNlY29uZHNEaXNwbGF5ID0gdGltZXIucXVlcnlTZWxlY3RvcignI3NlY29uZHMnKTtcclxuXHJcbiAgZnVuY3Rpb24gdXBkYXRlQ2xvY2soKSB7XHJcbiAgICB2YXIgdGltZSA9IGdldFRpbWVSZW1haW5pbmcoZW5kdGltZSk7XHJcblxyXG4gICAgc2Vjb25kc0Rpc3BsYXkuaW5uZXJIVE1MID0gKCcwJyArIHRpbWUuc2Vjb25kcykuc2xpY2UoLTIpO1xyXG5cclxuICBcdGlmICh0aW1lLnRvdGFsIDw9IDApIHtcclxuICBcdFx0Y2xlYXJJbnRlcnZhbCh0aW1laW50ZXJ2YWwpO1xyXG4gIFx0fVxyXG5cclxuICBcdGlmICh0aW1lLnNlY29uZHMgPT09IDEpIHtcclxuXHRcdFx0dmFyIG92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZW5kLWdhbWUnKTtcclxuXHRcdFx0VHdlZW5MaXRlLnRvKG92ZXJsYXksIDAuNSwge1xyXG5cdFx0XHRcdGRlbGF5OiAwLjUsXHJcblx0XHRcdFx0b3BhY2l0eTogMSxcclxuXHRcdFx0XHR6SW5kZXg6IDE1LFxyXG5cdFx0XHRcdGVhc2U6IFBvd2VyNC5lYXNlT3V0XHJcblx0XHRcdH0pO1xyXG4gIFx0fVxyXG4gICB9XHJcblxyXG4gIHVwZGF0ZUNsb2NrKCk7XHJcbiAgdmFyIHRpbWVpbnRlcnZhbCA9IHNldEludGVydmFsKHVwZGF0ZUNsb2NrLCAxMDAwKTtcclxufVxyXG5cclxudmFyIGNvdW50ZG93bkVuZHRpbWUgPSBuZXcgRGF0ZShEYXRlLnBhcnNlKG5ldyBEYXRlKCkpICsgMTUgKiAyNCAqIDYwICogNjAgKiAxMDAwKTtcclxuaW5pdGlhbGl6ZUNsb2NrKCd0aW1lci1jb250YWluZXInLCBjb3VudGRvd25FbmR0aW1lKTtcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuLy8gSGFuZGxlIGtleWJvYXJkIGNvbnRyb2xzXHJcbnZhciBrZXlzRG93biA9IHt9O1xyXG5cclxuLyoqXHJcbiAqIEdhbWUgbGF5b3V0IGFuZCBtZWNoYW5pY3NcclxuICovXHJcbnZhciBHYW1lID0gZnVuY3Rpb24oKSB7XHJcblx0dGhpcy5jYW52YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZ2FtZScpO1xyXG5cdHRoaXMuY3R4ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuXHR0aGlzLmNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xyXG5cdHRoaXMuY2FudmFzLmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcclxuXHJcblx0YWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uIChlKSB7XHJcblx0XHRrZXlzRG93bltlLmtleUNvZGVdID0gdHJ1ZTtcclxuXHR9LCBmYWxzZSk7XHJcblxyXG5cdGFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24gKGUpIHtcclxuXHRcdGRlbGV0ZSBrZXlzRG93bltlLmtleUNvZGVdO1xyXG5cdH0sIGZhbHNlKTtcclxuXHJcblx0dGhpcy5kaXNwbGF5Q29sbGVjdGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NvbGxlY3Rpb24nKTtcclxuXHJcblx0dGhpcy5pbml0KCk7XHJcblxyXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLl9vblJlc2l6ZS5iaW5kKHRoaXMpKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBpbml0aWFsaXplIGdhbWUgb2JqZWN0c1xyXG4gKi9cclxuR2FtZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG5cdHRoaXMuZHJhd0JhY2tncm91bmQoKTtcclxuXHR0aGlzLmRyYXdTYW50YSgpO1xyXG5cdHRoaXMuZHJhd0dpZnQoKTtcclxuXHR0aGlzLmRQYWQoKTtcclxuXHJcblx0dGhpcy50aGVuID0gRGF0ZS5ub3coKTtcclxuXHJcblx0Ly8gR2FtZSBvYmplY3RzXHJcblx0dGhpcy5zYW50YUNoYXJhY3RlciA9IHtcclxuXHRcdHNwZWVkOiAoMjU2ICogMikgLy8gbW92ZW1lbnQgaW4gcGl4ZWxzIHBlciBzZWNvbmRcclxuXHR9O1xyXG5cclxuXHR0aGlzLmdpZnRUb0dldCA9IHt9O1xyXG5cdHRoaXMuZ2lmdHNDb2xsZWN0ZWQgPSAwO1xyXG5cdHRoaXMuZGlzcGxheUNvbGxlY3RlZC5pbm5lckhUTUwgPSB0aGlzLmdpZnRzQ29sbGVjdGVkO1xyXG5cclxuXHR0aGlzLnNhbnRhQ2hhcmFjdGVyLnggPSB0aGlzLmNhbnZhcy53aWR0aCAvIDI7XHJcblx0dGhpcy5zYW50YUNoYXJhY3Rlci55ID0gdGhpcy5jYW52YXMuaGVpZ2h0IC8gMjtcclxuXHJcblx0dGhpcy5zZXRSYW5kb21HaWZ0TG9jYXRpb24oKTtcclxuXHR0aGlzLmFuaW1hdGUoKTtcclxuXHJcblx0dGhpcy5tb3ZpbmcgPSBmYWxzZTtcclxuXHR0aGlzLm1vdmluZ1ggPSBmYWxzZTtcclxuXHR0aGlzLm1vdmluZ1kgPSBmYWxzZTtcclxuXHJcblx0Ly8gdGFsbHkgYW5kIGRpc3BsYXkgc2NvcmUgYWZ0ZXIgNjBzXHJcblx0dmFyIG92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZW5kLWdhbWUnKTtcclxuXHRUd2VlbkxpdGUudG8ob3ZlcmxheSwgMC41LCB7XHJcblx0XHRkZWxheTogNTksXHJcblx0XHRvblN0YXJ0OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2ZpbmFsU2NvcmUnKS5pbm5lckhUTUwgPSB0aGlzLmdpZnRzQ29sbGVjdGVkICsgJyBsb3N0IHByZXNlbnRzISc7XHJcblx0XHR9LmJpbmQodGhpcylcclxuXHR9KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBsYXlzIG91dCBiZyBpbWFnZVxyXG4gKi9cclxuR2FtZS5wcm90b3R5cGUuZHJhd0JhY2tncm91bmQgPSBmdW5jdGlvbigpIHtcclxuXHR0aGlzLmJnSW1hZ2UgPSBuZXcgSW1hZ2UoKTtcclxuXHR0aGlzLmJnSW1hZ2Uuc3JjID0gJ2ltYWdlcy9iZy1pY2UtdGlsZS14LmpwZyc7XHJcbn07XHJcblxyXG4vKipcclxuICogbGF5cyBvdXQgc2FudGEgaW1hZ2VcclxuICovXHJcbkdhbWUucHJvdG90eXBlLmRyYXdTYW50YSA9IGZ1bmN0aW9uKCkge1xyXG5cdHRoaXMuc2FudGEgPSBuZXcgSW1hZ2UoKTtcclxuXHR0aGlzLnNhbnRhRmxpcCA9IG5ldyBJbWFnZSgpO1xyXG5cclxuXHR0aGlzLnNhbnRhLnNyYyA9ICdpbWFnZXMvc2FudGEtc2xlaWdoLnBuZyc7XHJcblx0dGhpcy5zYW50YUZsaXAuc3JjID0gJ2ltYWdlcy9zYW50YS1zbGVpZ2hfZmxpcC5wbmcnO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIGxheXMgb3V0IGdpZnQgaW1hZ2VcclxuICovXHJcbkdhbWUucHJvdG90eXBlLmRyYXdHaWZ0ID0gZnVuY3Rpb24oKSB7XHJcblx0dGhpcy5naWZ0ID0gbmV3IEltYWdlKCk7XHJcblx0dGhpcy5naWZ0LnNyYyA9ICdpbWFnZXMvZ2lmdC5wbmcnO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFRocm93IHRoZSBuZXcgZ2lmdCBzb21ld2hlcmUgb24gdGhlIHNjcmVlbiByYW5kb21seVxyXG4gKi9cclxuR2FtZS5wcm90b3R5cGUuc2V0UmFuZG9tR2lmdExvY2F0aW9uID0gZnVuY3Rpb24gKCkge1xyXG5cdHRoaXMuZ2lmdFRvR2V0LnggPSAzMiArIChNYXRoLnJhbmRvbSgpICogKHRoaXMuY2FudmFzLndpZHRoIC0gNjQpKTtcclxuXHR0aGlzLmdpZnRUb0dldC55ID0gMzIgKyAoTWF0aC5yYW5kb20oKSAqICh0aGlzLmNhbnZhcy5oZWlnaHQgLSA2NCkpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBnYW1lIG9iamVjdHNcclxuICovXHJcbkdhbWUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChtb2RpZmllcikge1xyXG5cdGlmICgzOCBpbiBrZXlzRG93bikgeyAvLyBQbGF5ZXIgaG9sZGluZyB1cFxyXG5cclxuXHRcdGlmICh0aGlzLnNhbnRhQ2hhcmFjdGVyLnkgPj0gNjQgJiYgIXRoaXMubW92aW5nWSkge1xyXG5cclxuXHRcdFx0dGhpcy5fbW92ZVVwKG1vZGlmaWVyKTtcclxuXHRcdH07XHJcblx0fVxyXG5cclxuXHRpZiAoNDAgaW4ga2V5c0Rvd24pIHsgLy8gUGxheWVyIGhvbGRpbmcgZG93blxyXG5cclxuXHRcdGlmICh0aGlzLnNhbnRhQ2hhcmFjdGVyLnkgPD0gdGhpcy5jYW52YXMuaGVpZ2h0IC0gMTI4ICYmICF0aGlzLm1vdmluZ1kpIHtcclxuXHRcdFx0dGhpcy5fbW92ZURvd24obW9kaWZpZXIpO1xyXG5cdFx0fTtcclxuXHR9XHJcblxyXG5cdGlmICgzNyBpbiBrZXlzRG93bikgeyAvLyBQbGF5ZXIgaG9sZGluZyBsZWZ0XHJcblxyXG5cdFx0dGhpcy5zYW50YS5zcmMgPSAnaW1hZ2VzL3NhbnRhLXNsZWlnaC5wbmcnO1xyXG5cclxuXHRcdGlmICh0aGlzLnNhbnRhQ2hhcmFjdGVyLnggPj0gNjQgJiYgIXRoaXMubW92aW5nWCkge1xyXG5cdFx0XHR0aGlzLl9tb3ZlTGVmdChtb2RpZmllcik7XHJcblx0XHR9O1xyXG5cdH1cclxuXHJcblx0aWYgKDM5IGluIGtleXNEb3duKSB7IC8vIFBsYXllciBob2xkaW5nIHJpZ2h0XHJcblxyXG5cdFx0dGhpcy5zYW50YS5zcmMgPSAnaW1hZ2VzL3NhbnRhLXNsZWlnaF9mbGlwLnBuZyc7XHJcblxyXG5cdFx0aWYgKHRoaXMuc2FudGFDaGFyYWN0ZXIueCA8PSAodGhpcy5jYW52YXMud2lkdGggLSAxMjgpICYmICF0aGlzLm1vdmluZ1gpIHtcclxuXHRcdFx0dGhpcy5fbW92ZVJpZ2h0KG1vZGlmaWVyKTtcclxuXHRcdH07XHJcblx0fVxyXG5cclxuXHQvLyBjb2xsaXNpb24gZGV0ZWN0aW9uXHJcblx0aWYgKHRoaXMuc2FudGFDaGFyYWN0ZXIueCA8PSAodGhpcy5naWZ0VG9HZXQueCArIDMyKSAmJiB0aGlzLmdpZnRUb0dldC54IDw9ICh0aGlzLnNhbnRhQ2hhcmFjdGVyLnggKyAzMikgJiYgdGhpcy5zYW50YUNoYXJhY3Rlci55IDw9ICh0aGlzLmdpZnRUb0dldC55ICsgMzIpXHJcbiAmJiB0aGlzLmdpZnRUb0dldC55IDw9ICh0aGlzLnNhbnRhQ2hhcmFjdGVyLnkgKyAzMikpIHtcclxuXHJcblx0XHRpZiAodGhpcy5naWZ0c0NvbGxlY3RlZCA+PSAwKSB7XHJcblx0XHRcdHRoaXMuZ2lmdHNDb2xsZWN0ZWQrKztcclxuXHJcblx0XHRcdHRoaXMuZGlzcGxheUNvbGxlY3RlZC5pbm5lckhUTUwgPSB0aGlzLmdpZnRzQ29sbGVjdGVkO1xyXG5cclxuXHRcdFx0dGhpcy5zZXRSYW5kb21HaWZ0TG9jYXRpb24oKTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG4vKipcclxuICogbW92ZSB1cCBtb3Rpb24vYW5pbWF0aW9uXHJcbiAqL1xyXG5HYW1lLnByb3RvdHlwZS5fbW92ZVVwID0gZnVuY3Rpb24obW9kaWZpZXIpIHtcclxuXHR0aGlzLm1vdmluZ1kgPSB0cnVlO1xyXG5cclxuXHRUd2VlbkxpdGUudG8odGhpcy5zYW50YUNoYXJhY3RlciwgMC43NSwge1xyXG5cdFx0eTogdGhpcy5zYW50YUNoYXJhY3Rlci55IC0gdGhpcy5zYW50YUNoYXJhY3Rlci5zcGVlZCAqIG1vZGlmaWVyLFxyXG5cdFx0ZWFzZTogUG93ZXIxLmVhc2VPdXQsXHJcblx0XHRvbkNvbXBsZXRlOiB0aGlzLl9oYXNGaW5pc2hlZE1vdmluZ1kuYmluZCh0aGlzKVxyXG5cdH0pO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIG1vdmUgZG93biBtb3Rpb24vYW5pbWF0aW9uXHJcbiAqL1xyXG5HYW1lLnByb3RvdHlwZS5fbW92ZURvd24gPSBmdW5jdGlvbihtb2RpZmllcikge1xyXG5cdHRoaXMubW92aW5nWSA9IHRydWU7XHJcblxyXG5cdFR3ZWVuTGl0ZS50byh0aGlzLnNhbnRhQ2hhcmFjdGVyLCAwLjc1LCB7XHJcblx0XHR5OiB0aGlzLnNhbnRhQ2hhcmFjdGVyLnkgKyB0aGlzLnNhbnRhQ2hhcmFjdGVyLnNwZWVkICogbW9kaWZpZXIsXHJcblx0XHRlYXNlOiBQb3dlcjEuZWFzZU91dCxcclxuXHRcdG9uQ29tcGxldGU6IHRoaXMuX2hhc0ZpbmlzaGVkTW92aW5nWS5iaW5kKHRoaXMpXHJcblx0fSk7XHJcbn07XHJcblxyXG4vKipcclxuICogbW92ZSBsZWZ0IG1vdGlvbi9hbmltYXRpb25cclxuICovXHJcbkdhbWUucHJvdG90eXBlLl9tb3ZlTGVmdCA9IGZ1bmN0aW9uKG1vZGlmaWVyKSB7XHJcblx0dGhpcy5tb3ZpbmdYID0gdHJ1ZTtcclxuXHJcblx0VHdlZW5MaXRlLnRvKHRoaXMuc2FudGFDaGFyYWN0ZXIsIDAuNzUsIHtcclxuXHRcdHg6IHRoaXMuc2FudGFDaGFyYWN0ZXIueCAtIHRoaXMuc2FudGFDaGFyYWN0ZXIuc3BlZWQgKiBtb2RpZmllcixcclxuXHRcdGVhc2U6IFBvd2VyMS5lYXNlT3V0LFxyXG5cdFx0b25Db21wbGV0ZTogdGhpcy5faGFzRmluaXNoZWRNb3ZpbmdYLmJpbmQodGhpcylcclxuXHR9KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBtb3ZlIHJpZ2h0IG1vdGlvbi9hbmltYXRpb25cclxuICovXHJcbkdhbWUucHJvdG90eXBlLl9tb3ZlUmlnaHQgPSBmdW5jdGlvbihtb2RpZmllcikge1xyXG5cdHRoaXMubW92aW5nWCA9IHRydWU7XHJcblxyXG5cdFR3ZWVuTGl0ZS50byh0aGlzLnNhbnRhQ2hhcmFjdGVyLCAwLjc1LCB7XHJcblx0XHR4OiB0aGlzLnNhbnRhQ2hhcmFjdGVyLnggKyB0aGlzLnNhbnRhQ2hhcmFjdGVyLnNwZWVkICogbW9kaWZpZXIsXHJcblx0XHRlYXNlOiBQb3dlcjEuZWFzZU91dCxcclxuXHRcdG9uQ29tcGxldGU6IHRoaXMuX2hhc0ZpbmlzaGVkTW92aW5nWC5iaW5kKHRoaXMpXHJcblx0fSk7XHJcbn07XHJcblxyXG4vKipcclxuICogZmluaXNoZWQgbW92aW5nIG9uIFggYXhpcyBmbGFnXHJcbiAqL1xyXG5HYW1lLnByb3RvdHlwZS5faGFzRmluaXNoZWRNb3ZpbmdYID0gZnVuY3Rpb24oKSB7XHJcblx0dGhpcy5tb3ZpbmdYID0gZmFsc2U7XHJcbn07XHJcblxyXG4vKipcclxuICogZmluaXNoZWQgbW92aW5nIG9uIFkgYXhpcyBmbGFnXHJcbiAqL1xyXG5HYW1lLnByb3RvdHlwZS5faGFzRmluaXNoZWRNb3ZpbmdZID0gZnVuY3Rpb24oKSB7XHJcblx0dGhpcy5tb3ZpbmdZID0gZmFsc2U7XHJcbn07XHJcblxyXG4vKipcclxuICogZmluaXNoZWQgbW92aW5nIGZsYWdcclxuICovXHJcbkdhbWUucHJvdG90eXBlLl9oYXNGaW5pc2hlZE1vdmluZyA9IGZ1bmN0aW9uKCkge1xyXG5cdHRoaXMubW92aW5nID0gZmFsc2U7XHJcbn07XHJcblxyXG4vKipcclxuICogZHJhdyBldmVyeXRoaW5nXHJcbiAqL1xyXG5HYW1lLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XHJcblx0dmFyIHJlcGVhdFBhdHRlcm4gPSB0aGlzLmN0eC5jcmVhdGVQYXR0ZXJuKHRoaXMuYmdJbWFnZSwgJ3JlcGVhdCcpOyAvLyBDcmVhdGUgYSBwYXR0ZXJuIHdpdGggdGhpcyBpbWFnZSwgYW5kIHNldCBpdCB0byAncmVwZWF0Jy5cclxuIFx0dGhpcy5jdHguZmlsbFN0eWxlID0gcmVwZWF0UGF0dGVybjtcclxuICB0aGlzLmN0eC5maWxsUmVjdCgwLCAwLCB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0KTtcclxuXHJcblx0dGhpcy5jdHguZHJhd0ltYWdlKHRoaXMuc2FudGEsIHRoaXMuc2FudGFDaGFyYWN0ZXIueCwgdGhpcy5zYW50YUNoYXJhY3Rlci55KTtcclxuXHR0aGlzLmN0eC5kcmF3SW1hZ2UodGhpcy5naWZ0LCB0aGlzLmdpZnRUb0dldC54LCB0aGlzLmdpZnRUb0dldC55KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBNYWluIGdhbWUgbG9vcFxyXG4gKi9cclxuR2FtZS5wcm90b3R5cGUuYW5pbWF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgbm93ID0gRGF0ZS5ub3coKTtcclxuXHR2YXIgZGVsdGEgPSBub3cgLSB0aGlzLnRoZW47XHJcblxyXG5cdHRoaXMudXBkYXRlKGRlbHRhIC8gMTUwKTtcclxuXHR0aGlzLnJlbmRlcigpO1xyXG5cclxuXHR0aGlzLnRoZW4gPSBub3c7XHJcblxyXG5cdHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLmFuaW1hdGUuYmluZCh0aGlzKSk7XHJcbn07XHJcblxyXG4vKipcclxuICogRGlyZWN0aW9uYWwgUGFkIC0gbW9iaWxlIHVpXHJcbiAqL1xyXG5HYW1lLnByb3RvdHlwZS5kUGFkID0gZnVuY3Rpb24oKSB7XHJcblx0Ly8gbW9iaWxlIGQgcGFkIG1vdmVtZW50XHJcblx0dmFyIHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3RvcCcpO1xyXG5cdHZhciBsZWZ0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xlZnQnKTtcclxuXHR2YXIgcmlnaHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcmlnaHQnKTtcclxuXHR2YXIgYm90dG9tID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2Rvd24nKTtcclxuXHJcbiAgLy8gdGFwIHVwXHJcbiAgdXAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuXHRcdGlmICh0aGlzLnNhbnRhQ2hhcmFjdGVyLnkgPj0gMCkge1xyXG5cdFx0XHRUd2VlbkxpdGUudG8odGhpcy5zYW50YUNoYXJhY3RlciwgMC4yNSwge1xyXG5cdFx0XHRcdHk6IHRoaXMuc2FudGFDaGFyYWN0ZXIueSAtIDI1LjUsXHJcblx0XHRcdFx0ZWFzZTogUG93ZXIxLmVhc2VPdXRcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cdH0uYmluZCh0aGlzKSk7XHJcblxyXG4gIC8vIHRhcCBkb3duXHJcbiAgZG93bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYgKHRoaXMuc2FudGFDaGFyYWN0ZXIueSA8PSB0aGlzLmNhbnZhcy5oZWlnaHQgLSA2NCkge1xyXG5cdFx0XHRUd2VlbkxpdGUudG8odGhpcy5zYW50YUNoYXJhY3RlciwgMC4yNSwge1xyXG5cdFx0XHRcdHk6IHRoaXMuc2FudGFDaGFyYWN0ZXIueSArIDI1LjUsXHJcblx0XHRcdFx0ZWFzZTogUG93ZXIxLmVhc2VPdXRcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cdH0uYmluZCh0aGlzKSk7XHJcblxyXG4gIC8vIHRhcCBsZWZ0XHJcbiAgbGVmdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYgKHRoaXMuc2FudGFDaGFyYWN0ZXIueCA+PSAwKSB7XHJcblx0XHRcdFR3ZWVuTGl0ZS50byh0aGlzLnNhbnRhQ2hhcmFjdGVyLCAwLjI1LCB7XHJcblx0XHRcdFx0eDogdGhpcy5zYW50YUNoYXJhY3Rlci54IC0gMjUuNSxcclxuXHRcdFx0XHRlYXNlOiBQb3dlcjEuZWFzZU91dFxyXG5cdFx0XHR9KTtcclxuXHRcdFx0dGhpcy5zYW50YS5zcmMgPSAnaW1hZ2VzL3NhbnRhLXNsZWlnaC5wbmcnO1xyXG5cdFx0fTtcclxuXHR9LmJpbmQodGhpcykpO1xyXG5cclxuICAvLyB0YXAgcmlnaHRcclxuICByaWdodC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYgKHRoaXMuc2FudGFDaGFyYWN0ZXIueCA8PSAodGhpcy5jYW52YXMud2lkdGggLSAzMikpIHtcclxuXHRcdFx0VHdlZW5MaXRlLnRvKHRoaXMuc2FudGFDaGFyYWN0ZXIsIDAuMjUsIHtcclxuXHRcdFx0XHR4OiB0aGlzLnNhbnRhQ2hhcmFjdGVyLnggKyAyNS41LFxyXG5cdFx0XHRcdGVhc2U6IFBvd2VyMS5lYXNlT3V0XHJcblx0XHRcdH0pO1xyXG5cdFx0XHR0aGlzLnNhbnRhLnNyYyA9ICdpbWFnZXMvc2FudGEtc2xlaWdoX2ZsaXAucG5nJztcclxuXHRcdH07XHJcblx0fS5iaW5kKHRoaXMpKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBvbiByZXNpemUgc3R1ZmZcclxuICovXHJcbkdhbWUucHJvdG90eXBlLl9vblJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdHRoaXMuY2FudmFzLndpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XHJcblx0dGhpcy5jYW52YXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xyXG5cclxuXHR0aGlzLmluaXQoKTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gR2FtZTtcclxuIl19"}